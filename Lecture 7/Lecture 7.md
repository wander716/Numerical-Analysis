# Numerical Analysis 数值积分

## Ⅰ：Numerical Integration Methods 数值积分基本方法
#### 一、基本思路：
n+1 个点 -> 构造 n 阶**拉格朗日插值多项式** -> 对该多项式积分
![1](数值积分基本方法-1.png)
![2](数值积分基本方法-2.png)
**表达式：**
![表达式](数值积分基本方法-3.png)
E(f)是残差。

#### 二、Trapezoidal Rule 梯形法则：
*即用一次线性函数去近似。亦即二点数值积分。*
示意图：
![示意图](梯形法则-示意图.png)
证明：
1. 写出拉格朗日插值多项式，并积分
![1](梯形法则-1.png)
2. 对残差项积分
![2](梯形法则-2.png)
3. 最后结果：
![3](梯形法则-3.png)

#### 三、Simpson’s Rule 辛普森法则：
*即三点数值积分，多加了一个中点。*
示意图：
![示意图](辛普森法则-示意图.png)
正常思路：
![1](辛普森法则-1.png)
想要更精确的······
*用泰勒插值多项式：*
![2-1](辛普森法则-2-1.png)
![2-2](辛普森法则-2-2.png)
![2-3](辛普森法则-2-3.png)
![2-4](辛普森法则-2-4.png)
![2-5](辛普森法则-2-5.png)
结论：
![结论](辛普森法则-结论.png)

#### 四、Newton-Cotes Formulas：
梯形法则和辛普森法则其实是Newton-Cotes公式的特殊情况。
**公式：**
![公式](<Newton-Cotes Formulas.png>)
特值代入：
![特值代入](<Newton-Cotes Formulas 特值代入.png>)

## Ⅱ：Composite Numerical Integration 组合数值积分

#### 一、辛普森法则
![1](组合数值积分-1.png)
![2](组合数值积分-2.png)
![3](组合数值积分-3.png)
![4](组合数值积分-4.png)
**公式：**
![公式](组合数值积分-公式.png)
**与一般数值积分方法的精确度比较：**
![精确度分析](组合数值积分-精确度分析.png)

#### 二、梯形法则
示意图：
![梯形-示意图](组合数值积分-梯形-示意图.png)
**公式：**
![梯形-公式](组合数值积分-梯形-公式.png)

#### 三、舍入误差分析
以辛普森法则的公式为例：
![舍入误差分析](组合数值积分-舍入误差分析.png)
*最终的舍入误差与计算数量无关。即，n可以很大，每次的计算区间很小。*

## Ⅲ：Romberg Integration 龙贝格积分方法
注意到：组合数值积分，会在原积分的基础上误差阶数变小。  
如：梯形法则 由$0$($h^3$)降为$0$($h^2$) ；辛普森法则 由$0$($h^5$)降为$0$($h^4$)。  
为了提高精度，考虑理查森外推法！
**思路：
梯形法则 + 组合数值积分 + 理查森外推法**  
#### 公式推导：
下面以梯形法则为例：
![1](龙贝格积分方法-1.png)
![2](龙贝格积分方法-2.png)
![3](龙贝格积分方法-3.png)
需满足的收敛条件：
![收敛条件](龙贝格积分方法-收敛条件.png)  
#### Example:
![1](龙贝格-E1.png)
![2](龙贝格-E2.png)
![3](龙贝格-E3.png)
![4](龙贝格-E4.png)
![5](龙贝格-E5.png)
![6](龙贝格-E6.png)
可见，最后一行的结果已经非常接近精确的积分结果 2 了。
